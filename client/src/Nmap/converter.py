import json
import io

search_string = 'Version'
search_ip = 'ip'
with open('./fil.csv', mode='r') as infile:
        with open('outfile.json', mode='a') as f:
            f.writelines("]")
            ioses = []
            ips = []
            for line in infile:
                if search_string in line:
                    word = line.split(',')[1].split(',')[0]
                    ios = word.split('Version ')[1]
                    ioses.append(ios)
                if search_ip in line:
                    ip = line.split('ip ')[1].strip()
                    ips.append(ip)
            for num, cheese in zip(ioses, ips):
                with open('outfile.json', mode='a') as outfile:
                            outfile.write(" " + "{" + '"' + "ios" + '"' + ":" + '"' + '{}'.format(num) + '"' + "," + "\n" + '"' + "ip" + '"' + ":" + '"' + '{}'.format(cheese) + '"' + "}" + ",")

with open('outfile.json', mode='r+') as f:
        content = f.read()
        f.seek(0, 0)
        f.write("[")

with open("outfile.json") as f:
        lines = f.readlines()
        lines[-1] = lines[-1].replace(',', '')

with open('outfile.json', 'w') as file:
    file.writelines( lines )
